# Chat Codex Reader

## Overview

The Chat Codex Reader is a sophisticated, single-file web application designed for the academic review and analysis of long-form AI chat transcripts. It transforms raw, multi-turn chat logs into a professional, interactive reading experience that mimics the structure of a formal paper, complete with a robust citation system.

This project was built to solve the problem of analyzing complex, structured data generated by AI models like Gemini, where each "completion" consists of both reasoning (preamble) and main content. The reader cleanly separates these elements and provides stable, citable references for every paragraph.

## Key Features

*   **Paper Selection Screen**: On launch, the application presents a modal overlay allowing the user to select from a list of available JSON documents.
*   **Dynamic Reading Mode**: After a paper is selected, the interface dynamically builds a clean, focused reading view.
*   **Persistent Citation System**:
    *   Every paragraph, heading, and list item in the main content is automatically assigned a unique, sequential citation number.
    *   A fixed **Citation Ruler** on the left side of the screen displays these numbers, visually connected to their corresponding text block by a dotted line.
    *   Citation numbers are interactive; clicking one highlights the associated text.
*   **Toggleable Reasoning**: The AI's "reasoning" or "preamble" for each completion is displayed in a distinct, collapsible block, allowing the user to focus on either the process or the final output.
*   **Completion Navigation**: A sticky top navigation bar provides buttons to instantly jump to any AI completion within the document.
*   **URL-based Loading**: Papers can be loaded directly by passing the filename as a URL parameter (e.g., `?paper=my_paper.json`).

## How It Works

The system consists of two main components: a Python parser and the HTML front-end.

1.  **Data Source**: The raw data resides in Python scripts (e.g., `john-olivers-despair-index.py`). These scripts contain the chat history as a list of `types.Content` objects from the Gemini API.
2.  **Parsing**: The `parse_script.py` script is run from the command line. It uses Python's Abstract Syntax Tree (`ast`) module to safely parse the source `.py` files, extract the chat `contents`, and write them into a structured `.json` file. This process preserves the distinction between the "user" and "model" roles and the different `parts` of each message.
3.  **Front-End Rendering**: The `reader-codex-05.html` file (the latest and most stable version) contains all the necessary HTML, CSS, and JavaScript.
    *   On load, it fetches the list of available `.json` files to populate the selection screen.
    *   When a paper is selected, it fetches the corresponding JSON data.
    *   It then iterates through the model's completions, intelligently separating the first `part` (the reasoning/preamble) from the subsequent `parts` (the main content).
    *   It renders the content as HTML, assigns citation numbers, and builds the navigation and citation ruler dynamically.

## File Descriptions

*   `parse_script.py`: The Python parser script. Run this to convert a `.py` source file into a `.json` data file.
*   `*.py` (e.g., `spencer-brown-analysis-of-text.py`): The raw data source files containing the chat logs.
*   `*.json` (e.g., `spencer-brown-analysis-of-text.json`): The structured JSON data files generated by the parser, which are consumed by the front-end.
*   `reader-codex-05.html`: The main, self-contained web application. This is the file you should open in your browser.
*   `reader-codex-01.html` to `reader-codex-04.html`: Previous development versions, kept for historical purposes. `05` contains all the latest features and bug fixes.

## How to Use

1.  **Generate/Update Data**: If you have a new or updated `.py` source file, run the parser:
    ```bash
    python3 parse_script.py your_source_file.py -o your_output_file.json
    ```
2.  **Start the Web Server**: The application must be run from a local web server to allow for fetching the JSON files.
    ```bash
    python3 -m http.server 8000
    ```
3.  **Open the Reader**: Navigate to the following URL in your web browser:
    [http://localhost:8000/reader-codex-05.html](http://localhost:8000/reader-codex-05.html)
